<ion-grid (click)="displayContent(post)">
  <ion-row lines="none">
    <ion-avatar
      slot=""
      class="ion-padding"
      *ngIf="isUserConnected != post?.user?._id"
    >
      <img
        [src]="apiImgUser + post?.user?.photo"
        (click)="getfollow(post?.user?._id)"
      />
    </ion-avatar>
    <ion-label
      (click)="getfollow(post?.user?._id)"
      class="ion-justify-content-center"
      *ngIf="isUserConnected != post?.user?._id"
      style="display: grid; align-self: center"
    >
      <h3
        class="
          ion-text-capitalize
          ion-align-self-start
          ion-justify-content-start
          ion-text-start
        "
        routerLinkActive="router-link-active"
      >
        {{ post?.user?.name }}
      </h3>
      <p>{{ post?.createdAt | date }}</p>
    </ion-label>

    <ion-avatar
      slot=""
      class="ion-padding"
      *ngIf="isUserConnected === post?.user?._id"
    >
      <img
        [src]="apiImgUser + post?.user?.photo"
        routerLink="/menu/tabs/layouts/coachprofile/{{ post.user.id }}/me"
      />
    </ion-avatar>

    <ion-label
      [routerLink]="['/menu/tabs/layouts/coachprofile/coachphoto']"
      class="ion-justify-content-center"
      *ngIf="isUserConnected === post?.user?._id"
      style="display: grid; align-self: center"
    >
      <h3
        class="
          ion-text-capitalize
          ion-align-self-start
          ion-justify-content-start
          ion-text-start
        "
        routerLinkActive="router-link-active"
      >
        {{ post?.user?.name }}
      </h3>
      <p>{{ post?.createdAt | date }}</p>
    </ion-label>

    <ion-button
      color="light"
      slot="end"
      shape="round"
      fill="clear"
      size="small"
      (click)="presentPopover($event)"
    >
      <ion-icon
        color="light"
        style="color: #fff"
        slot="icon-only"
        name="ellipsis-vertical"
      >
      </ion-icon>
    </ion-button>
  </ion-row>
  <ion-row
    lines="none"
    class="ion-justify-content-center ion-margin"
    *ngIf="images.length > 0"
  >
    <img [lazyLoad]="apiImg + images[0]?.image_name" />
  </ion-row>
  <div *ngIf="newMediaFiles.length > 0 && thirdNewMediaFiles.length === 0" >
    <div style="display: flex; justify-content: center" > 
      <div *ngFor="let file of newMediaFiles">
        <ng-container *ngIf="getExt(file.file_name) === 'png'">
          <div
            style="width: 250px"
            id="first"
            [style.background-size]="'cover'"
            [style.background-image]="'url(' + apiImg + file?.file_name + ')'"
            [lazyLoad]="apiImg + file?.file_name"
            errorImage="../../../assets/imgs/150.png"
            (click)="displayImage(file)"
          >
            <ion-icon></ion-icon>
          </div>
        </ng-container>
        <ng-container *ngIf="getExt(file.file_name) === 'mp4'">
          <div
            style="
              margin-left: 15px;
              width: 250px;
              height: 200px;
              display: flex;
              justify-content: center;
              align-items: center;
              border-radius: 10px;
            "
            [style.background-size]="'cover'"
            [style.background-image]="'url(../../../assets/imgs/150.png)'"
            errorImage="../../../assets/imgs/150.png"
            (click)="displayVideo(file)"
          >
            <ion-icon
              style="height: 50px; width: 50px"
              name="videocam"
            ></ion-icon>
          </div>
        </ng-container>
      </div>
      <div class="nextContainer" >
        <div *ngFor="let file of mediafiles" >
          <ng-container *ngIf="getExt(file.file_name) === 'png'">
            <div
              id="next"
              [style.background-size]="'cover'"
              [style.background-image]="'url(' + apiImg + file?.file_name + ')'"
              [lazyLoad]="apiImg + file?.file_name"
              errorImage="../../../assets/imgs/150.png"
              (click)="displayImage(mediafiles)"
            >
              <ion-icon></ion-icon>
            </div>
          </ng-container>
          <ng-container *ngIf="getExt(file.file_name) === 'mp4'">
            <div
              [style.background-size]="'cover'"
              [style.background-image]="'url(../../../assets/imgs/150.png)'"
              errorImage="../../../assets/imgs/150.png"
              (click)="displayVideo(mediafiles)"
            >
              <ion-icon name="videocam"></ion-icon>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="secondNewMediaFiles.length !== 0">
    <div style="display: flex"  >
      <div *ngFor="let file of newMediaFiles">
        <ng-container *ngIf="getExt(file.file_name) === 'png'">
          <div
            id="first"
            [style.background-size]="'cover'"
            [style.background-image]="'url(' + apiImg + file?.file_name + ')'"
            [lazyLoad]="apiImg + file?.file_name"
            errorImage="../../../assets/imgs/150.png"
            (click)="displayImage(mediafiles)"
          >
            <ion-icon></ion-icon>
          </div>
        </ng-container>
        <ng-container *ngIf="getExt(file.file_name) === 'mp4'">
          <div
            style="
              margin-left: 15px;
              width: 250px;
              height: 200px;
              display: flex;
              justify-content: center;
              align-items: center;
              border-radius: 10px;
            "
            [style.background-size]="'cover'"
            [style.background-image]="'url(../../../assets/imgs/150.png)'"
            errorImage="../../../assets/imgs/150.png"
            (click)="displayVideo(file)"
          >
            <ion-icon
              style="height: 50px; width: 50px"
              name="videocam"
            ></ion-icon>
          </div>
        </ng-container>
      </div>
      <div class="nextContainer" style="position: relative">
        <div *ngFor="let file of thirdNewMediaFiles">
          <ng-container *ngIf="getExt(file.file_name) === 'png'">
            <div
              id="next"
              [style.background-size]="'cover'"
              [style.background-image]="'url(' + apiImg + file?.file_name + ')'"
              [lazyLoad]="apiImg + file?.file_name"
              errorImage="../../../assets/imgs/150.png"
              (click)="displayImage(file)"
            >
              <ion-icon></ion-icon>
            </div>
          </ng-container>
          <!-- <p style="color: black">{{ secondNewMediaFiles.lenght }}</p> -->
          <ng-container *ngIf="getExt(file.file_name) === 'mp4'">
            <div
              [style.background-size]="'cover'"
              [style.background-image]="'url(../../../assets/imgs/150.png)'"
              errorImage="../../../assets/imgs/150.png"
              (click)="displayVideo(file)"
            >
              <ion-icon name="videocam"></ion-icon>
            </div>
          </ng-container>
        </div>
        <div
          (click)="displayImage(mediafiles)"
          style="
            position: absolute;
            background-color: rgba(0, 0, 0, 0.219);
            color: rgb(255, 255, 255);
            font-size: 20px;
            bottom: 0;
            left: 0;
            width: 95px;
            height: 95px;
            border-radius: 5px;
            margin: 1px 0 0 1px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
          "
        >
          + {{ this.secondNewMediaFiles.length }}
        </div>
      </div>
    </div>
  </div>

  <ion-row>
    <ion-card-content>
      {{ post?.content }}
    </ion-card-content>
  </ion-row>
  <ion-row lines="none">
    <ion-col size="col-2">
      <ion-chip>
        <ng-container
          *ngIf="!post?.likedBy.includes(user?._id); else dislikedTemp"
        >
          <ion-button
            (dblclick)="showReactions($event)"
            (click)="like(post, $event.target)"
            shape="round"
            fill="clear"
            size="large"
          >
            <img
              src="../../../../assets/iconPost/{{ post?.iconLike }}.svg"
              class="iconstyle"
              id="icon_liked"
            />
            <sub>{{ post?.likes }} </sub>
          </ion-button>
        </ng-container>
        <ng-template #dislikedTemp>
          <ion-button
            (dblclick)="showReactions($event)"
            (click)="disLike(post, $event.target)"
            shape="round"
            fill="clear"
            size="large"
          >
            <img
              src="../../../../assets/iconPost/{{ post?.iconLike }}.svg"
              id="icon_like"
            />
            <sub>{{ post?.likes }} </sub>
          </ion-button>
        </ng-template>
      </ion-chip>
    </ion-col>
    <ion-col style="text-align: end">
      <ion-chip>
        <ion-button
          (click)="presentModal(post)"
          shape="round"
          fill="clear"
          size="large"
        >
          <img
            class="iconstyle"
            src="../../../../assets/iconPost/icon_comment.svg"
          />
          <sub>{{ comments?.length }}</sub>
        </ion-button>
        <ng-container *ngIf="!bookmarked; else unbook">
          <ion-button
            (click)="bookmark(post)"
            shape="round"
            fill="clear"
            size="large "
          >
            <img
              class="iconstyle"
              src="../../../../assets/iconPost/icon_bookmark.svg"
            />
            <sub>{{ post?.favorisNb }}</sub>
          </ion-button>
        </ng-container>
        <ng-template #unbook>
          <ion-button
            (click)="unBookmark(post)"
            shape="round"
            fill="clear"
            size="large "
          >
            <img
              class="iconstyle"
              src="../../../../assets/iconPost/icon_bookmarked.svg"
            />
            <sub>{{ post?.favorisNb }}</sub>
          </ion-button>
        </ng-template>
        <ion-button (click)="share()" shape="round" fill="clear" size="large ">
          <img
            class="iconstyle"
            src="../../../../assets/iconPost/icon_share.svg"
          />
        </ion-button>
      </ion-chip>
    </ion-col>
  </ion-row>
</ion-grid>
