<app-header [isPage]="true"></app-header>

<ion-content [scrollEvents]="true">
  <div style="position: relative;">
    <div style="position: absolute;bottom:15px;left:10px;display:flex;flex-direction:column;align-items:center">
      <div style="position: relative">
        <ion-avatar style="position: absolute; top:50px; left:300px;" class="edit-profile-cover"
          (click)="selectImageSource()" *ngIf="page?.createdBy._id === userid">
          <ion-icon name="create" color="light"> </ion-icon>
        </ion-avatar>
      </div>
      <div style="postion:relative">
        <img (click)="updateImage = true" *ngIf="!page?.photo"
          style="width:70px;height:70px;margin-right:10px;background-color:white;border-radius:50%;padding:5px;"
          src="../../../assets/svg/person-icon.svg" alt="">
        <img (click)="updateImage = true; selectProfileSource()" *ngIf="page?.photo"
          style="width:70px;height:70px;margin-right:10px;background-color:white;border-radius:50%;padding:5px;"
          src="{{apiImg+page?.photo}}" alt="">

      </div>

      <span style="font-size: 18px;color:white"> {{page?.name}} </span>
    </div>
    <img *ngIf="page?.cover" src="{{apiImg+page?.cover}} " alt="">
    <img *ngIf="!page?.cover"
      src="https://images.fastcompany.net/image/upload/w_596,c_limit,q_auto:best,f_auto/wp-cms/uploads/2021/03/LinkedIn-Default-Background-2020-.jpg"
      alt="">

    <ion-avatar style="position: absolute; top:0px; left: 0px;" class="edit-profile-cover" (click)="selectImageSource()"
      *ngIf="page?.createdBy._id === userid">
      <ion-icon name="create" c class="createIcom" style="height:0px; width:0px;"> </ion-icon>
    </ion-avatar>
  </div>
  <div style="background-color: rgb(241, 241, 241);height:100%">
    <div style="display: flex;">
      <ion-segment style="display:flex; align-items:center;justify-content:space-around;padding:0 5px;width:100%;"
        (ionChange)="segmentChanged($event)">
        <ion-segment-button value="Acceuil">
          Acceuil
        </ion-segment-button>
        <ion-segment-button value="A propos">
          A propos
        </ion-segment-button>
        <ion-segment-button value="Photos">
          Photos
        </ion-segment-button>
      </ion-segment>
      <button>
        Message
      </button>

      <div *ngIf="userid!==page?.createdBy._id">
        <ng-container *ngIf="followedPage===true;else notFollowed">
          <button style="color:green;font-weight:bold" (click)="toggleFollow()">
            Suivre
          </button>
        </ng-container>
        <ng-template #notFollowed>
          <button style="background-color: green;color:white" (click)="toggleFollow()">
            Suivie
          </button>
        </ng-template>
      </div>
      <button style="position: relative;width:20px;height:15px;margin-top:12px">
        <div style="position:relative;">
          <ion-icon (click)="openDropDown()" (blur)="openDropDown()" name="ellipsis-horizontal"
            style="display: flex;justify-content:center;align-items:center;height:15px"></ion-icon>
          <ng-container *ngIf="dropDown">
            <div
              style="font-size:15px;position: absolute;background-color:rgb(243, 243, 243);padding:10px;border-radius:15px;transform:translateX(-210px) translateY(20px);display:flex;flex-direction:column;width:210px;color:rgb(168, 168, 168);box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.562);justify-content:space-around;align-items:flex-start;">
              <span>Rechercher dans la page</span>
              <hr>
              <ion-item (click)="getAllfriends()">
                <ion-label>Inviter des amis</ion-label>
                <ion-select [(ngModel)]="selectedFriends" multiple="true" ok-text="okey!" cancel-text="Nah">
                  <ion-select-option *ngFor="let friend of friends" value="{{friend?.userFollowed._id}}">
                    {{friend?.userFollowed.name}}</ion-select-option>
                </ion-select>
              </ion-item>
              <hr>
              <span>Signaler la page</span>
              <hr>
              <span>Bloquer la page</span>
            </div>
          </ng-container>
        </div>
      </button>

    </div>

    <div *ngIf="selected === 'Acceuil'">
      <div *ngIf="page?.createdBy._id === userid"
        style="display:flex;align-items:center;background-color:rgb(226, 226, 226);padding:8px 10px;margin:5px;border-radius:25px;justify-content:space-between;margin:20px 10px">
        <input placeholder="Exprimez vous!" type="text" style="border: none;background-color:unset">
        <img (click)="openShareModal()" style="width:20px;height:20px;" src="../../../assets/svg/black-add-page.svg"
          alt="">
      </div>
      <div style="padding: 10px;font-size:12px;color:rgb(107, 107, 107);background-color:white;margin:10px 0"
        *ngFor="let post of posts">
        <div style="display: flex;align-items:center">
          <img
            style="width:30px;height:30px;margin-right:10px;background-color:rgb(212, 212, 212);border-radius:50%;padding:5px"
            src="{{apiImg+page?.photo}}" alt="">
          <div style="display: flex;flex-direction:column;justify-content:space-around">
            <span>{{page?.name}} </span>
            <!--
 <span style="font-size:8px;">Coach sportif</span>
           -->
          </div>
        </div>
        <div style="line-height: 20px;;margin:10px 0">
          {{post?.content }}
        </div>
        <div>
          <div *ngFor="let file of post.mediafiles">
            <ng-container>
              <div style="width: 350px; height: 220px">
                <img src="{{apiImg+file?.file_name}}" alt="">
              </div>
            </ng-container>
          </div>
        </div>
        <div style="display: flex; justify-content:space-between;padding:5px 15px;width:100%">
          <div style="display: flex;align-items:center">
            <span style="margin-right:10px">983</span>
            <img style="width: 20px;height:20px;" src="../../../assets/iconPost/icon_like.svg" alt="">
          </div>
          <div style="display: flex;align-items:center">
            <div style="display: flex;align-items:center;margin-right:15px">
              <span style="margin-right:10px">175</span>
              <img style="width: 20px;height:20px;" src="../../../assets/iconPost/icon_comment.svg" alt="">
            </div>
            <img style="width: 20px;height:20px;margin-right:5px" src="../../../assets/iconPost/icon_bookmark.svg"
              alt="">
            <img style="width: 20px;height:20px;" src="../../../assets/svg/share-event.svg" alt="">
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="selected === 'A propos'">
      <ion-icon name="create" class="createIcom" *ngIf="page?.createdBy._id === userid"
        (click)="update === false ? update = true: update = false"></ion-icon>
      <div *ngIf="update=== false">
        <div style="font-size: 17px;font-weight:bold;margin:10px 0 35px 15px ">
          <span style="margin-right:10px">300</span>
          <span>Participants</span>
        </div>
        <div style="margin: 15px;">
          <div>
            <span style="font-size: 17px;font-weight:bold">Page :</span>
            <span>{{page?.name}}</span>
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Lieu :</span>
            <span>{{page?.address}}</span>
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Contact :</span>
            <span>{{page?.phone}}</span>
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Site web :</span>
            <span>{{page?.webSite}}</span>
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Email :</span>
            <span>{{page?.email}}</span>
          </div>
        </div>
        <ng-container *ngIf="more===false;else showmore">
          <div style="margin-left: 15px; white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
            <span style="font-size: 17px;font-weight:bold;">Description :</span>
            <span>
              {{page?.description}}
            </span>
          </div>
          <span style="margin-left:15px;font-weight:bold;font-size:10px" (click)="toggleShowMore()">voir plus</span>
        </ng-container>
        <ng-template #showmore>
          <div style="margin-left: 15px; ">
            <span style="font-size: 17px;font-weight:bold;">Description :</span>
            <span>
              {{page?.description}}
            </span>
          </div><span style="margin-left:15px;font-weight:bold;font-size:10px" (click)="toggleShowMore()">voir
            moins</span>
        </ng-template>
      </div>

      <div *ngIf="update">
        <div style="margin: 15px;">
          <div>
            <span style="font-size: 17px;font-weight:bold">Page :</span>
            <input [(ngModel)]="page.name" class="input" placeholder="{{page?.name}}" />
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Lieu :</span>
            <input [(ngModel)]="page.address" class="input" placeholder="Adresse" />
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Contact :</span>
            <input [(ngModel)]="page.phone" class="input" placeholder="88 888 888" />
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Site web :</span>
            <input [(ngModel)]="page.website" class="input" placeholder="www.sportup.com" />
          </div>
          <div>
            <span style="font-size: 17px;font-weight:bold">Email :</span>
            <input [(ngModel)]="page.email" class="input" placeholder="sportup@gmail.com" />
          </div>
        </div>
        <ng-container *ngIf="more===false;else showmore">
          <div style="margin-left: 15px; white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
            <span style="font-size: 17px;font-weight:bold;">Description :</span>
            <input [(ngModel)]="page.description" class="input" placeholder="{{page?.description}}" />
          </div>
          <span style="margin-left:15px;font-weight:bold;font-size:10px" (click)="toggleShowMore()">voir plus</span>
        </ng-container>
        <ng-template #showmore>
          <div style="margin-left: 15px; ">
            <span style="font-size: 17px;font-weight:bold;">Description :</span>
            <span>
              {{page?.description}}
            </span>
          </div><span style="margin-left:15px;font-weight:bold;font-size:10px" (click)="toggleShowMore()">voir
            moins</span>
        </ng-template>
        <div style="display: flex;justify-content:flex-end ">
          <img (click)="updatePage()" style="width: 30px;height:30px;margin: 20px 10px 0 0;"
            src="../../../../assets/svg/green-tick.svg" alt="">
          <img (click)="update = false" style="width: 30px;height:30px;margin: 20px 10px 0 0;"
            src="../../../../assets/svg/red-x.svg" alt="">
        </div>

      </div>

    </div>
    <div *ngIf="selected === 'Photos'">
      <div style="display: flex;margin:10px">
        <div style="display: flex;">
          <img *ngIf="images[0]" style="border-radius:15px;height: 144.5px;width:144.5px;object-fit:cover"
            src="{{apiImg+images[0]?.file_name}}" alt="">
          <img *ngIf="images[1]"
            style="border-radius:15px;height: 144.5px;width:144.5px;margin-left:10px;object-fit:cover"
            src="{{apiImg+images[1]?.file_name}}" alt="">
        </div>
        <div style="display: flex;flex-direction:column">
          <img *ngIf="images[2]"
            style="border-radius:15px;height: 67px;width:67px;margin:0 0 10px 10px;object-fit:cover"
            src="{{apiImg+images[2]?.file_name}}" alt="">
          <img *ngIf="images[3]" style="border-radius:15px;height: 67px;width:67px;margin-left:10px;object-fit:cover"
            src="{{apiImg+images[3]?.file_name}}" alt="">
        </div>
      </div>
      <div style="display: flex;flex-wrap:wrap;width:100%;margin-left:10px">
        <div *ngFor="let image of images | slice:4">
          <img style="width: 67px;height:67px;border-radius:15px;margin-right:10px;object-fit:cover"
            src="{{apiImg+image?.file_name}}" alt="">
        </div>
      </div>
    </div>

  </div>
</ion-content>
